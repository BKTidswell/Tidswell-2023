m1=zeros(2*2,3);
m2=zeros(2*2,1);

m1(1:2:2*2,1)=[1,2];
m1(1:2:2*2,2)=[3,4];
m1(1:2:2*2,3)=[5,6];

m1(2:2:2*2,1)=[7,8];
m1(2:2:2*2,2)=[9,10];
m1(2:2:2*2,3)=[11,12];

m2(1:2:2*2,1)=[1,2];
m2(2:2:2*2,1)=[3,4];

% xyz = linsolve(m1,m2);

% disp(m1)
% disp(m2)
% 
% disp(xyz)

c = [-3.5183e+03 -2.8969e+03; 9.3071e+01 -1.7519e+01; -2.7702e+02 -1.5001e+03; 1.2696e+03  1.1242e+03; -2.2867e+02  1.0591e+02; -3.3464e+03 -3.1174e+03; -4.8504e+02 -4.9441e+02; 5.6453e+02  6.4405e+02; -2.3536e-01  1.5716e-01; -7.9101e-03 -7.1783e-04; -9.2809e-01 -8.7398e-01; 1.0000e+00  1.0000e+00];

camPts = [1266.0, 542.0 768.0, 696.5];

%c = [-3.5183e+03 -2.8969e+03; 9.3071e+01 -1.7519e+01; -2.7702e+02 -1.5001e+03; 1.2696e+03  1.1242e+03; -2.2867e+02  1.0591e+02; -3.3464e+03 -3.1174e+03; -4.8504e+02 -4.9441e+02; 5.6453e+02  6.4405e+02; -2.3536e-01  1.5716e-01; -7.9101e-03 -7.1783e-04; -9.2809e-01 -8.7398e-01]
%camPts = [1690.  519. 1580.  302.]

i = 1;
cdx = [1,2];

m1=[];
m2=[];

disp(camPts(i,cdx*2-1));
disp(c(9,cdx));
disp(c(1,cdx));

m1(1:2:numel(cdx)*2,1)=camPts(i,cdx*2-1).*c(9,cdx)-c(1,cdx);
m1(1:2:numel(cdx)*2,2)=camPts(i,cdx*2-1).*c(10,cdx)-c(2,cdx);
m1(1:2:numel(cdx)*2,3)=camPts(i,cdx*2-1).*c(11,cdx)-c(3,cdx);
m1(2:2:numel(cdx)*2,1)=camPts(i,cdx*2).*c(9,cdx)-c(5,cdx);
m1(2:2:numel(cdx)*2,2)=camPts(i,cdx*2).*c(10,cdx)-c(6,cdx);
m1(2:2:numel(cdx)*2,3)=camPts(i,cdx*2).*c(11,cdx)-c(7,cdx);

m2(1:2:numel(cdx)*2,1)=c(4,cdx)-camPts(i,cdx*2-1);
m2(2:2:numel(cdx)*2,1)=c(8,cdx)-camPts(i,cdx*2);

% get the least squares solution to the reconstruction
xyz(i,1:3)=linsolve(m1,m2);

disp(m1)
disp(m2)
disp(xyz)